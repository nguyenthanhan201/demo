/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/@supabase/storage-js@2.6.0/dist/module/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
class t extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function e(t){return"object"==typeof t&&null!==t&&"__isStorageError"in t}class r extends t{constructor(t,e){super(t),this.name="StorageApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class n extends t{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}}var o=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{u(n.next(t))}catch(t){i(t)}}function a(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}u((n=n.apply(t,e||[])).next())}))};const i=t=>{let e;return e=t||("undefined"==typeof fetch?(...t)=>import("/npm/@supabase/node-fetch@2.6.15/+esm").then((({default:e})=>e(...t))):fetch),(...t)=>e(...t)};var s=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{u(n.next(t))}catch(t){i(t)}}function a(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}u((n=n.apply(t,e||[])).next())}))};const a=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),u=(t,e)=>s(void 0,void 0,void 0,(function*(){const i=yield o(void 0,void 0,void 0,(function*(){return"undefined"==typeof Response?(yield import("/npm/@supabase/node-fetch@2.6.15/+esm")).Response:Response}));t instanceof i?t.json().then((n=>{e(new r(a(n),t.status||500))})).catch((t=>{e(new n(a(t),t))})):e(new n(a(t),t))})),c=(t,e,r,n)=>{const o={method:t,headers:(null==e?void 0:e.headers)||{}};return"GET"===t?o:(o.headers=Object.assign({"Content-Type":"application/json"},null==e?void 0:e.headers),o.body=JSON.stringify(n),Object.assign(Object.assign({},o),r))};function d(t,e,r,n,o,i){return s(this,void 0,void 0,(function*(){return new Promise(((s,a)=>{t(r,c(e,n,o,i)).then((t=>{if(!t.ok)throw t;return(null==n?void 0:n.noResolveJson)?t:t.json()})).then((t=>s(t))).catch((t=>u(t,a)))}))}))}function h(t,e,r,n){return s(this,void 0,void 0,(function*(){return d(t,"GET",e,r,n)}))}function l(t,e,r,n,o){return s(this,void 0,void 0,(function*(){return d(t,"POST",e,n,o,r)}))}function f(t,e,r,n,o){return s(this,void 0,void 0,(function*(){return d(t,"DELETE",e,n,o,r)}))}var p=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{u(n.next(t))}catch(t){i(t)}}function a(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}u((n=n.apply(t,e||[])).next())}))};const v={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},y={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class m{constructor(t,e={},r,n){this.url=t,this.headers=e,this.bucketId=r,this.fetch=i(n)}uploadOrUpdate(t,r,n,o){return p(this,void 0,void 0,(function*(){try{let e;const i=Object.assign(Object.assign({},y),o),s=Object.assign(Object.assign({},this.headers),"POST"===t&&{"x-upsert":String(i.upsert)});"undefined"!=typeof Blob&&n instanceof Blob?(e=new FormData,e.append("cacheControl",i.cacheControl),e.append("",n)):"undefined"!=typeof FormData&&n instanceof FormData?(e=n,e.append("cacheControl",i.cacheControl)):(e=n,s["cache-control"]=`max-age=${i.cacheControl}`,s["content-type"]=i.contentType);const a=this._removeEmptyFolders(r),u=this._getFinalPath(a),c=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:e,headers:s},(null==i?void 0:i.duplex)?{duplex:i.duplex}:{})),d=yield c.json();if(c.ok)return{data:{path:a,id:d.Id,fullPath:d.Key},error:null};return{data:null,error:d}}catch(t){if(e(t))return{data:null,error:t};throw t}}))}upload(t,e,r){return p(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",t,e,r)}))}uploadToSignedUrl(t,r,n,o){return p(this,void 0,void 0,(function*(){const i=this._removeEmptyFolders(t),s=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${s}`);a.searchParams.set("token",r);try{let t;const e=Object.assign({upsert:y.upsert},o),r=Object.assign(Object.assign({},this.headers),{"x-upsert":String(e.upsert)});"undefined"!=typeof Blob&&n instanceof Blob?(t=new FormData,t.append("cacheControl",e.cacheControl),t.append("",n)):"undefined"!=typeof FormData&&n instanceof FormData?(t=n,t.append("cacheControl",e.cacheControl)):(t=n,r["cache-control"]=`max-age=${e.cacheControl}`,r["content-type"]=e.contentType);const s=yield this.fetch(a.toString(),{method:"PUT",body:t,headers:r}),u=yield s.json();if(s.ok)return{data:{path:i,fullPath:u.Key},error:null};return{data:null,error:u}}catch(t){if(e(t))return{data:null,error:t};throw t}}))}createSignedUploadUrl(r,n){return p(this,void 0,void 0,(function*(){try{let e=this._getFinalPath(r);const o=Object.assign({},this.headers);(null==n?void 0:n.upsert)&&(o["x-upsert"]="true");const i=yield l(this.fetch,`${this.url}/object/upload/sign/${e}`,{},{headers:o}),s=new URL(this.url+i.url),a=s.searchParams.get("token");if(!a)throw new t("No token returned by API");return{data:{signedUrl:s.toString(),path:r,token:a},error:null}}catch(t){if(e(t))return{data:null,error:t};throw t}}))}update(t,e,r){return p(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",t,e,r)}))}move(t,r,n){return p(this,void 0,void 0,(function*(){try{return{data:yield l(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:null==n?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(t){if(e(t))return{data:null,error:t};throw t}}))}copy(t,r,n){return p(this,void 0,void 0,(function*(){try{return{data:{path:(yield l(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:null==n?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(t){if(e(t))return{data:null,error:t};throw t}}))}createSignedUrl(t,r,n){return p(this,void 0,void 0,(function*(){try{let e=this._getFinalPath(t),o=yield l(this.fetch,`${this.url}/object/sign/${e}`,Object.assign({expiresIn:r},(null==n?void 0:n.transform)?{transform:n.transform}:{}),{headers:this.headers});const i=(null==n?void 0:n.download)?`&download=${!0===n.download?"":n.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${i}`)},{data:o,error:null}}catch(t){if(e(t))return{data:null,error:t};throw t}}))}createSignedUrls(t,r,n){return p(this,void 0,void 0,(function*(){try{const e=yield l(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),o=(null==n?void 0:n.download)?`&download=${!0===n.download?"":n.download}`:"";return{data:e.map((t=>Object.assign(Object.assign({},t),{signedUrl:t.signedURL?encodeURI(`${this.url}${t.signedURL}${o}`):null}))),error:null}}catch(t){if(e(t))return{data:null,error:t};throw t}}))}download(t,r){return p(this,void 0,void 0,(function*(){const n=void 0!==(null==r?void 0:r.transform)?"render/image/authenticated":"object",o=this.transformOptsToQueryString((null==r?void 0:r.transform)||{}),i=o?`?${o}`:"";try{const e=this._getFinalPath(t),r=yield h(this.fetch,`${this.url}/${n}/${e}${i}`,{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(t){if(e(t))return{data:null,error:t};throw t}}))}getPublicUrl(t,e){const r=this._getFinalPath(t),n=[],o=(null==e?void 0:e.download)?`download=${!0===e.download?"":e.download}`:"";""!==o&&n.push(o);const i=void 0!==(null==e?void 0:e.transform)?"render/image":"object",s=this.transformOptsToQueryString((null==e?void 0:e.transform)||{});""!==s&&n.push(s);let a=n.join("&");return""!==a&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${a}`)}}}remove(t){return p(this,void 0,void 0,(function*(){try{return{data:yield f(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(t){if(e(t))return{data:null,error:t};throw t}}))}list(t,r,n){return p(this,void 0,void 0,(function*(){try{const e=Object.assign(Object.assign(Object.assign({},v),r),{prefix:t||""});return{data:yield l(this.fetch,`${this.url}/object/list/${this.bucketId}`,e,{headers:this.headers},n),error:null}}catch(t){if(e(t))return{data:null,error:t};throw t}}))}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}}const g={"X-Client-Info":"storage-js/2.6.0"};var b=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{u(n.next(t))}catch(t){i(t)}}function a(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}u((n=n.apply(t,e||[])).next())}))};class w{constructor(t,e={},r){this.url=t,this.headers=Object.assign(Object.assign({},g),e),this.fetch=i(r)}listBuckets(){return b(this,void 0,void 0,(function*(){try{return{data:yield h(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(e(t))return{data:null,error:t};throw t}}))}getBucket(t){return b(this,void 0,void 0,(function*(){try{return{data:yield h(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(t){if(e(t))return{data:null,error:t};throw t}}))}createBucket(t,r={public:!1}){return b(this,void 0,void 0,(function*(){try{return{data:yield l(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(e(t))return{data:null,error:t};throw t}}))}updateBucket(t,r){return b(this,void 0,void 0,(function*(){try{const e=yield function(t,e,r,n,o){return s(this,void 0,void 0,(function*(){return d(t,"PUT",e,n,o,r)}))}(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers});return{data:e,error:null}}catch(t){if(e(t))return{data:null,error:t};throw t}}))}emptyBucket(t){return b(this,void 0,void 0,(function*(){try{return{data:yield l(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(e(t))return{data:null,error:t};throw t}}))}deleteBucket(t){return b(this,void 0,void 0,(function*(){try{return{data:yield f(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(t){if(e(t))return{data:null,error:t};throw t}}))}}class $ extends w{constructor(t,e={},r){super(t,e,r)}from(t){return new m(this.url,this.headers,t,this.fetch)}}export{r as StorageApiError,$ as StorageClient,t as StorageError,n as StorageUnknownError,e as isStorageError};export default null;
//# sourceMappingURL=/sm/b9cdb49db13b789382e8b572b9e7cb1e3ad6f463970af297990327bff8166475.map